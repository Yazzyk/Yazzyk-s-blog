<!DOCTYPE html>
<html lang="zh-cn">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Yazzyk&#39;s Blog</title>
  <meta name="author" content="Yazzyk" />
  
  <meta name="description" content="本篇文章以我所用教务系统为例 由于学校把课表关闭了，所以我现在先爬取的成绩查询 本项目的完整代码地址：Github-zhengfang 首先观察学校官网的地址： 原本的地址是 https://220.167.53.63:95/ 然后变成 https://220.167.53.63:95/(4eggunep4b4jhzfwhk4pva21)/default2.aspx 首先端口使用的95端" />
  
  <meta name="keywords" content="">
  <meta name="baidu-site-verification" content="code-TtzfDaB45q" />
  <meta name="google-site-verification" content="kAjz9Ic_7Hir1rNUQtXSxTydJTryAv8JMelb2Qvnges" />
  <link rel="shortcut icon" href="https://shroot.dev/img/favicon.png" type="image/x-icon">
  <link rel="stylesheet" href="https://shroot.dev/css/white.css">
  
  
  <link href="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.2.1/css/all.min.css" rel="stylesheet">
  
  
  
  <script src="https://shroot.dev/js/jQuery.min.js" async="async"></script>
  <script src="https://shroot.dev/js/lodash.js" async="async"></script>
  <script src="https://shroot.dev/js/baidu.js" async="async"></script>
  
  <link rel="stylesheet" href="https://shroot.dev/css/main.css">
  
</head>
<body>
  <div class="nav">
  <div class="logoBox">
    <a href="/posts"><img src="/img/logo.png" alt="" class="logo"></a>
  </div>
  
  <ul>
    
    
    <li><a class="linkBox" href="/">欢迎页</a></li>
    
    <li><a class="linkBox" href="/posts">文章</a></li>
    
    <li><a class="linkBox" href="/about">关于我</a></li>
    
    <li><a class="linkBox" href="/tags">分类</a></li>
    
    <li><a class="linkBox" href="/links">友链</a></li>
    
  </ul>
</div>
<div class="header">
  <div class="subTitle">
    
    芝灵生于幽谷,不以无人而不芳
    
  </div>
  <div class="socials">
    <div class="socialLinks">
      
      <a href="mailto:917885215@qq.com" target="_blank"><i class="fa-solid fa-envelope" aria-hidden="true"></i></a>
      
      <a href="https://github.com/Yazzyk" target="_blank"><i class="fa-brands fa-github" aria-hidden="true"></i></a>
      
      <a href="#ZgotmplZ" target="_blank"><i class="fa-brands fa-qq" aria-hidden="true"></i></a>
      
      <a href="https://space.bilibili.com/10061915" target="_blank"><i class="fa-solid fa-tv" aria-hidden="true"></i></a>
      
    </div>
  </div>
</div>
  <div class="main">
    <div class="postContent">
      <h1>Python3 正方爬虫</h1>
      <small><i class="fa fa-clock-o" aria-hidden="true"></i>2018-08-11
        Yazzyk</small>
      <h1 id="本篇文章以我所用教务系统为例">本篇文章以我所用教务系统为例</h1>
<p>由于学校把课表关闭了，所以我现在先爬取的成绩查询 本项目的完整代码地址：<a href="https://github.com/idoctype/zhengfang">Github-zhengfang</a> 首先观察学校官网的地址： <a href="https://img.css0209.cn/2018/08/Xnip2018-08-12_19-57-19.jpg"><img src="https://img.css0209.cn/2018/08/Xnip2018-08-12_19-57-19.jpg" alt=""></a> 原本的地址是 https://220.167.53.63:95/ 然后变成 https://220.167.53.63:95/(4eggunep4b4jhzfwhk4pva21)/default2.aspx 首先端口使用的95端口，95端口是非安全端口，现在的主流浏览器应该是无法访问的，这里我只提供要用到的Chrome的Mac版的解决方案,具体可以参考我的文章 <a href="https://css0209.cn/2018/09/10/251/">Chrome/Firefox非安全端口问题</a> 打开终端复制以下命令，最后的<code>--explicitly-allowed-ports=95</code>中的95就是你想打开的非安全端口号</p>
<p>/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome &ndash;explicitly-allowed-ports=95</p>
<p>然后是<code>(4eggunep4b4jhzfwhk4pva21)</code>中间的这窜数字，刷新几次后发现这个是会变的，也就是不确定的 default2.aspx是登录页面 再来看看NetWork的信息 <a href="https://cloud.css0209.cn/2018/08/8FF2E09F-E9C7-44AC-980E-204355B34118.jpg"><img src="https://cloud.css0209.cn/2018/08/8FF2E09F-E9C7-44AC-980E-204355B34118.jpg" alt=""></a> 在我们访问https://220.167.53.63:95/时进行了以个302跳转，那么在302跳转之前是个什么东西呢？ 我用Burp Suite Professional抓包工具来看看：  <a href="https://cloud.css0209.cn/2018/08/F138B3AB-E6F8-4FFA-92F5-29F5C9744776.jpg"><img src="https://cloud.css0209.cn/2018/08/F138B3AB-E6F8-4FFA-92F5-29F5C9744776.jpg" alt=""></a> 得到上图中的信息然后我们可以发现<code>(bfpyl355aa3owdf50bdgfg55)</code>正好是我们需要的那段随机生成的值，也就是说，我们可以通过先爬取这个页面中的内容获得这个值，我们将这个值命名为token，然后代码如下： （由于这个博客的编辑器比较皮，所以格式可能有点不对，没法输制表符）</p>
<div class="highlight"><div style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">19
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#54b1c7">-*-</span> <span style="color:#aa89ea">coding</span><span style="color:#abb2bf">:</span> <span style="color:#aa89ea">UTF</span><span style="color:#54b1c7">-</span><span style="color:#d19a66">8</span> <span style="color:#54b1c7">-*-</span>
    <span style="color:#76a9f9">import</span> <span style="color:#ca72ff">urllib.parse</span>
    <span style="color:#76a9f9">import</span> <span style="color:#ca72ff">requests</span>
    <span style="color:#76a9f9">import</span> <span style="color:#ca72ff">re</span>
    <span style="color:#76a9f9">import</span> <span style="color:#ca72ff">PIL</span>
    <span style="color:#76a9f9">from</span> <span style="color:#ca72ff">PIL</span> <span style="color:#76a9f9">import</span> <span style="color:#aa89ea">Image</span>
    <span style="color:#76a9f9">from</span> <span style="color:#ca72ff">bs4</span> <span style="color:#76a9f9">import</span> <span style="color:#aa89ea">BeautifulSoup</span>

    <span style="color:#aa89ea">session</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">requests</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">Session</span><span style="color:#abb2bf">()</span> <span style="color:#8a93a5;font-style:italic"># 初始化session</span>

    <span style="color:#76a9f9">class</span> <span style="color:#ca72ff">ZF</span><span style="color:#abb2bf">:</span>
     <span style="color:#aa89ea">初始化</span>
         <span style="color:#76a9f9">def</span> <span style="color:#aa89ea">__init__</span><span style="color:#abb2bf">(</span><span style="color:#aa89ea">self</span><span style="color:#abb2bf">):</span>
               <span style="color:#aa89ea">self</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">url</span> <span style="color:#54b1c7">=</span> <span style="color:#98c379">&#39;https://220.167.53.63:95/&#39;</span> <span style="color:#8a93a5;font-style:italic"># 链接</span>
               <span style="color:#aa89ea">s</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">session</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">get</span><span style="color:#abb2bf">(</span><span style="color:#98c379">&#39;</span><span style="color:#98c379">{}</span><span style="color:#98c379">default2.aspx&#39;</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">format</span><span style="color:#abb2bf">(</span><span style="color:#aa89ea">self</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">url</span><span style="color:#abb2bf">),</span><span style="color:#aa89ea">allow_redirects</span><span style="color:#54b1c7">=</span><span style="color:#e5c07b">False</span><span style="color:#abb2bf">)</span> <span style="color:#8a93a5;font-style:italic"># allow_redirects:重定向；会话，get方法获取页面，防止302重定向</span>
               <span style="color:#aa89ea">pattern</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">re</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">compile</span><span style="color:#abb2bf">(</span><span style="color:#63c381">&#34;href=&#39;/\((\w*)\)&#34;</span><span style="color:#abb2bf">)</span> <span style="color:#8a93a5;font-style:italic"># 正则表达式</span>
               <span style="color:#aa89ea">token</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">pattern</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">findall</span><span style="color:#abb2bf">(</span><span style="color:#aa89ea">s</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">text</span><span style="color:#abb2bf">)</span> <span style="color:#8a93a5;font-style:italic"># 查询页面中信息，匹配正则表达式并保存到列表token</span>
               <span style="color:#aa89ea">self</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">token</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">token</span><span style="color:#abb2bf">[</span><span style="color:#d19a66">0</span><span style="color:#abb2bf">]</span> <span style="color:#8a93a5;font-style:italic"># 取出列表中的token,并赋值</span>
               <span style="color:#aa89ea">self</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">index_url</span> <span style="color:#54b1c7">=</span> <span style="color:#63c381">&#34;https://220.167.53.63:95/(</span><span style="color:#98c379">{}</span><span style="color:#63c381">)/default2.aspx&#34;</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">format</span><span style="color:#abb2bf">(</span><span style="color:#aa89ea">self</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">token</span><span style="color:#abb2bf">)</span> <span style="color:#8a93a5;font-style:italic"># 定义主页地址 </span>
</code></pre></td></tr></table>
</div>
</div><p>接下来我们登录观察并获取信息： <a href="https://www.css0209.cn/wp-content/uploads/2018/08/9F85AC9C-3E51-4AB2-B82A-0288A1C7A618-300x169.jpg"></a><a href="https://cloud.css0209.cn/2018/08/9F85AC9C-3E51-4AB2-B82A-0288A1C7A618-300x169.jpg"><img src="https://cloud.css0209.cn/2018/08/9F85AC9C-3E51-4AB2-B82A-0288A1C7A618.jpg" alt=""></a> 通过观察发现url地址的<code>defult2.aspx</code>变成了<code>xs_main.aspx?xh=[学号]</code> 提交的表单信息中有6个值</p>
<h1 id="__viewstate">__VIEWSTATE</h1>
<p>不知道是什么东西，但是会变，猜测和<code>csrf</code>类似</p>
<table>
<thead>
<tr>
<th>值</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>TextBox1</td>
<td>学号</td>
</tr>
<tr>
<td>TextBox2</td>
<td>密码</td>
</tr>
<tr>
<td>TextBox3</td>
<td>验证码</td>
</tr>
<tr>
<td>RadioButtonList1</td>
<td>登录页面学生的那个选框</td>
</tr>
<tr>
<td>Button1</td>
<td>永远都是空白</td>
</tr>
</tbody>
</table>
<p>学号，密码，可以通过用户输入得到 <code>Button1</code>,和<code>RadioButtonList1</code>的值是固定的，而且<code>RadioButtonList1</code>如果在表单中不存在就会默认为学生选项 也就是说我们只需要解决验证码和<code>__VIEWSTATE</code>的值</p>
<p>回到登录页面观察form表单 <a href="https://cloud.css0209.cn/2018/08/BD67EEAA-9F8A-4362-B9D2-9C34CB854145-300x163.jpg"></a><a href="https://cloud.css0209.cn/2018/08/BD67EEAA-9F8A-4362-B9D2-9C34CB854145-300x163.jpg"><img src="https://cloud.css0209.cn/2018/08/BD67EEAA-9F8A-4362-B9D2-9C34CB854145.jpg" alt=""></a> 很快便可以发现在form标签后面紧跟了一个input标签里面的value就是我们要的__VIEWSTATE的值 那么代码如下:</p>
<div class="highlight"><div style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">33
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python3" data-lang="python3"><span style="color:#8a93a5;font-style:italic"># -*- coding: UTF-8 -*-</span>
<span style="color:#76a9f9">import</span> <span style="color:#ca72ff">urllib.parse</span>
<span style="color:#76a9f9">import</span> <span style="color:#ca72ff">requests</span>
<span style="color:#76a9f9">import</span> <span style="color:#ca72ff">re</span>
<span style="color:#76a9f9">import</span> <span style="color:#ca72ff">PIL</span>
<span style="color:#76a9f9">from</span> <span style="color:#ca72ff">PIL</span> <span style="color:#76a9f9">import</span> <span style="color:#aa89ea">Image</span>
<span style="color:#76a9f9">from</span> <span style="color:#ca72ff">bs4</span> <span style="color:#76a9f9">import</span> <span style="color:#aa89ea">BeautifulSoup</span>

<span style="color:#aa89ea">session</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">requests</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">Session</span><span style="color:#abb2bf">()</span>  <span style="color:#8a93a5;font-style:italic"># 初始化session</span>


<span style="color:#76a9f9">class</span> <span style="color:#ca72ff">ZF</span><span style="color:#abb2bf">:</span>
    <span style="color:#8a93a5;font-style:italic"># 初始化</span>
    <span style="color:#76a9f9">def</span> <span style="color:#aa89ea">__init__</span><span style="color:#abb2bf">(</span><span style="color:#aa89ea">self</span><span style="color:#abb2bf">):</span>
        <span style="color:#aa89ea">self</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">url</span> <span style="color:#54b1c7">=</span> <span style="color:#98c379">&#39;http://220.167.53.63:95/&#39;</span>  <span style="color:#8a93a5;font-style:italic"># 链接</span>
        <span style="color:#aa89ea">s</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">session</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">get</span><span style="color:#abb2bf">(</span><span style="color:#98c379">&#39;</span><span style="color:#98c379">{}</span><span style="color:#98c379">default2.aspx&#39;</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">format</span><span style="color:#abb2bf">(</span><span style="color:#aa89ea">self</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">url</span><span style="color:#abb2bf">),</span>
                        <span style="color:#aa89ea">allow_redirects</span><span style="color:#54b1c7">=</span><span style="color:#e5c07b">False</span><span style="color:#abb2bf">)</span>  <span style="color:#8a93a5;font-style:italic"># allow_redirects:重定向；会话，get方法获取页面，防止302重定向</span>
        <span style="color:#aa89ea">pattern</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">re</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">compile</span><span style="color:#abb2bf">(</span><span style="color:#63c381">&#34;href=&#39;/\((\w*)\)&#34;</span><span style="color:#abb2bf">)</span>  <span style="color:#8a93a5;font-style:italic"># 正则表达式</span>
        <span style="color:#aa89ea">token</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">pattern</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">findall</span><span style="color:#abb2bf">(</span><span style="color:#aa89ea">s</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">text</span><span style="color:#abb2bf">)</span>  <span style="color:#8a93a5;font-style:italic"># 查询页面中信息，匹配正则表达式并保存到列表token</span>
        <span style="color:#aa89ea">self</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">token</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">token</span><span style="color:#abb2bf">[</span><span style="color:#d19a66">0</span><span style="color:#abb2bf">]</span>  <span style="color:#8a93a5;font-style:italic"># 取出列表中的token,并赋值</span>
        <span style="color:#aa89ea">self</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">index_url</span> <span style="color:#54b1c7">=</span> <span style="color:#63c381">&#34;http://220.167.53.63:95/(</span><span style="color:#98c379">{}</span><span style="color:#63c381">)/default2.aspx&#34;</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">format</span><span style="color:#abb2bf">(</span><span style="color:#aa89ea">self</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">token</span><span style="color:#abb2bf">)</span>  <span style="color:#8a93a5;font-style:italic"># 定义主页地址</span>
        <span style="color:#8a93a5;font-style:italic"># requests过去页面信息</span>
        <span style="color:#aa89ea">r</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">requests</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">get</span><span style="color:#abb2bf">(</span><span style="color:#aa89ea">self</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">index_url</span><span style="color:#abb2bf">)</span>
        <span style="color:#aa89ea">r</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">encoding</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">r</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">apparent_encoding</span>
        <span style="color:#8a93a5;font-style:italic"># beautifulsoup格式化内容，用lxml解析</span>
        <span style="color:#aa89ea">soup</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">BeautifulSoup</span><span style="color:#abb2bf">(</span><span style="color:#aa89ea">r</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">text</span><span style="color:#abb2bf">,</span> <span style="color:#98c379">&#39;lxml&#39;</span><span style="color:#abb2bf">)</span>
        <span style="color:#8a93a5;font-style:italic"># 从页面中获取__VIEWSTATE</span>
        <span style="color:#aa89ea">self</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">__VIEWSTATE</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">soup</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">select_one</span><span style="color:#abb2bf">(</span><span style="color:#98c379">&#39;input[name=&#34;__VIEWSTATE&#34;]&#39;</span><span style="color:#abb2bf">)</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">get</span><span style="color:#abb2bf">(</span><span style="color:#63c381">&#34;value&#34;</span><span style="color:#abb2bf">)</span>
        <span style="color:#8a93a5;font-style:italic"># 学号和密码</span>
        <span style="color:#8a93a5;font-style:italic"># self.user = &#39;&#39;</span>
        <span style="color:#8a93a5;font-style:italic"># self.pwd = &#39;&#39;</span>
        <span style="color:#aa89ea">self</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">user</span> <span style="color:#54b1c7">=</span> <span style="color:#e5c07b">input</span><span style="color:#abb2bf">(</span><span style="color:#63c381">&#34;请输入学号：&#34;</span><span style="color:#abb2bf">)</span>
        <span style="color:#aa89ea">self</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">pwd</span> <span style="color:#54b1c7">=</span> <span style="color:#e5c07b">input</span><span style="color:#abb2bf">(</span><span style="color:#63c381">&#34;请输入密码：&#34;</span><span style="color:#abb2bf">)</span>
</code></pre></td></tr></table>
</div>
</div><h1 id="验证码">验证码</h1>
<p>验证码获取很简单: 直接鼠标右键复制图片链接，复制下来会发现就是<code>default2.aspx</code>变成了<code>CheckCode.aspx</code> <img src="https://cloud.css0209.cn/2018/08/F0696265-FDA9-49E9-A2EA-D9B041B8687E.jpg" alt=""> 那么我们只需要把验证码以二进制的形式下载下来，需要的时候调用，能打开显示就行 代码如下:</p>
<div class="highlight"><div style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python3" data-lang="python3"><span style="color:#8a93a5;font-style:italic"># 获取验证码图片并保存至本地，再打开</span>
    <span style="color:#76a9f9">def</span> <span style="color:#00b1f7">captchas</span><span style="color:#abb2bf">(</span><span style="color:#aa89ea">self</span><span style="color:#abb2bf">):</span>
        <span style="color:#76a9f9">try</span><span style="color:#abb2bf">:</span>
            <span style="color:#aa89ea">url</span> <span style="color:#54b1c7">=</span> <span style="color:#63c381">&#34;https://220.167.53.63:95/(</span><span style="color:#98c379">{}</span><span style="color:#63c381">)/CheckCode.aspx&#34;</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">format</span><span style="color:#abb2bf">(</span><span style="color:#aa89ea">self</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">token</span><span style="color:#abb2bf">)</span>  <span style="color:#8a93a5;font-style:italic"># 验证码图片地址</span>
            <span style="color:#aa89ea">img_r</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">requests</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">get</span><span style="color:#abb2bf">(</span><span style="color:#aa89ea">url</span><span style="color:#abb2bf">)</span>  <span style="color:#8a93a5;font-style:italic"># 获取验证码图片</span>
            <span style="color:#8a93a5;font-style:italic"># 以二进制保存至本地</span>
            <span style="color:#76a9f9">with</span> <span style="color:#e5c07b">open</span><span style="color:#abb2bf">(</span><span style="color:#98c379">&#39;./img/captcha.jpg&#39;</span><span style="color:#abb2bf">,</span> <span style="color:#98c379">&#39;wb&#39;</span><span style="color:#abb2bf">)</span> <span style="color:#76a9f9">as</span> <span style="color:#aa89ea">f</span><span style="color:#abb2bf">:</span>
                <span style="color:#aa89ea">f</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">write</span><span style="color:#abb2bf">(</span><span style="color:#aa89ea">img_r</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">content</span><span style="color:#abb2bf">)</span>
            <span style="color:#8a93a5;font-style:italic"># 利用PIL打开图片</span>
            <span style="color:#aa89ea">PIL</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">Image</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">open</span><span style="color:#abb2bf">(</span><span style="color:#98c379">&#39;./img/captcha.jpg&#39;</span><span style="color:#abb2bf">)</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">show</span><span style="color:#abb2bf">()</span>
            <span style="color:#8a93a5;font-style:italic"># 让用户输入验证码</span>
            <span style="color:#76a9f9">return</span> <span style="color:#e5c07b">input</span><span style="color:#abb2bf">(</span><span style="color:#63c381">&#34;请输入验证码：&#34;</span><span style="color:#abb2bf">)</span>
        <span style="color:#76a9f9">except</span><span style="color:#abb2bf">:</span>
            <span style="color:#e5c07b">print</span><span style="color:#abb2bf">(</span><span style="color:#63c381">&#34;error:获取验证码失败&#34;</span><span style="color:#abb2bf">)</span> 
</code></pre></td></tr></table>
</div>
</div><p>获取了需要的信息，我们就可以进行模拟登陆了，这里我们登录后获取一下用户姓名并URL化，后面会用到:</p>
<h1 id="模拟登陆">模拟登陆</h1>
<div class="highlight"><div style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">28
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python3" data-lang="python3">    <span style="color:#76a9f9">def</span> <span style="color:#00b1f7">login</span><span style="color:#abb2bf">(</span><span style="color:#aa89ea">self</span><span style="color:#abb2bf">):</span>
        <span style="color:#8a93a5;font-style:italic"># http://220.167.53.63:95/(2gfd5m3bax5l2rigc0yfiofq)/xs_main.aspx?xh=201713013059</span>
        <span style="color:#76a9f9">try</span><span style="color:#abb2bf">:</span>

            <span style="color:#aa89ea">url</span> <span style="color:#54b1c7">=</span> <span style="color:#63c381">&#34;http://220.167.53.63:95/(</span><span style="color:#98c379">{}</span><span style="color:#63c381">)/default2.aspx&#34;</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">format</span><span style="color:#abb2bf">(</span><span style="color:#aa89ea">self</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">token</span><span style="color:#abb2bf">)</span>  <span style="color:#8a93a5;font-style:italic"># 生成登陆地址</span>
            <span style="color:#8a93a5;font-style:italic"># 用字典保存data</span>
            <span style="color:#aa89ea">data</span> <span style="color:#54b1c7">=</span> <span style="color:#abb2bf">{</span>
                <span style="color:#98c379">&#39;__VIEWSTATE&#39;</span><span style="color:#abb2bf">:</span> <span style="color:#aa89ea">self</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">__VIEWSTATE</span><span style="color:#abb2bf">,</span>
                <span style="color:#98c379">&#39;TextBox1&#39;</span><span style="color:#abb2bf">:</span> <span style="color:#aa89ea">self</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">user</span><span style="color:#abb2bf">,</span>
                <span style="color:#98c379">&#39;TextBox2&#39;</span><span style="color:#abb2bf">:</span> <span style="color:#aa89ea">self</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">pwd</span><span style="color:#abb2bf">,</span>
                <span style="color:#98c379">&#39;TextBox3&#39;</span><span style="color:#abb2bf">:</span> <span style="color:#aa89ea">self</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">captchas</span><span style="color:#abb2bf">(),</span>
                <span style="color:#98c379">&#39;Button1&#39;</span><span style="color:#abb2bf">:</span> <span style="color:#98c379">&#39;&#39;</span>
            <span style="color:#abb2bf">}</span>
            <span style="color:#aa89ea">r</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">session</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">post</span><span style="color:#abb2bf">(</span><span style="color:#aa89ea">url</span><span style="color:#abb2bf">,</span> <span style="color:#aa89ea">data</span><span style="color:#54b1c7">=</span><span style="color:#aa89ea">data</span><span style="color:#abb2bf">)</span>
            <span style="color:#aa89ea">r</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">encoding</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">r</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">apparent_encoding</span>  <span style="color:#8a93a5;font-style:italic"># 修改编码为网页编码</span>
            <span style="color:#8a93a5;font-style:italic"># 检查提交后URL中是否含有&#39;xs_main.aspx?xh=&#39;，如果有就表示登陆成功</span>
            <span style="color:#76a9f9">if</span> <span style="color:#98c379">&#39;xs_main.aspx?xh=&#39;</span> <span style="color:#b756ff;font-weight:bold">in</span> <span style="color:#aa89ea">r</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">url</span><span style="color:#abb2bf">:</span>
                <span style="color:#aa89ea">soup</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">BeautifulSoup</span><span style="color:#abb2bf">(</span><span style="color:#aa89ea">r</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">text</span><span style="color:#abb2bf">,</span> <span style="color:#98c379">&#39;lxml&#39;</span><span style="color:#abb2bf">)</span>
                <span style="color:#e5c07b">print</span><span style="color:#abb2bf">(</span><span style="color:#98c379">&#39;登陆成功</span><span style="color:#d26464;font-weight:bold">\n</span><span style="color:#98c379">欢迎您：&#39;</span><span style="color:#abb2bf">,</span> <span style="color:#aa89ea">soup</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">select_one</span><span style="color:#abb2bf">(</span><span style="color:#98c379">&#39;.info span#xhxm&#39;</span><span style="color:#abb2bf">)</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">text</span><span style="color:#abb2bf">)</span>
                <span style="color:#8a93a5;font-style:italic"># 获取姓名</span>
                <span style="color:#aa89ea">name</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">re</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">sub</span><span style="color:#abb2bf">(</span><span style="color:#98c379">&#39;同学&#39;</span><span style="color:#abb2bf">,</span> <span style="color:#98c379">&#39;&#39;</span><span style="color:#abb2bf">,</span> <span style="color:#aa89ea">soup</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">select_one</span><span style="color:#abb2bf">(</span><span style="color:#98c379">&#39;.info span#xhxm&#39;</span><span style="color:#abb2bf">)</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">text</span><span style="color:#abb2bf">)</span>
                <span style="color:#8a93a5;font-style:italic"># 将姓名URL化</span>
                <span style="color:#aa89ea">xm</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">urllib</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">parse</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">quote</span><span style="color:#abb2bf">(</span><span style="color:#aa89ea">name</span><span style="color:#abb2bf">)</span>
                <span style="color:#76a9f9">return</span> <span style="color:#aa89ea">xm</span>
            <span style="color:#76a9f9">else</span><span style="color:#abb2bf">:</span>
                <span style="color:#e5c07b">print</span><span style="color:#abb2bf">(</span><span style="color:#98c379">&#39;登陆失败&#39;</span><span style="color:#abb2bf">,</span> <span style="color:#aa89ea">r</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">url</span><span style="color:#abb2bf">)</span>
        <span style="color:#76a9f9">except</span><span style="color:#abb2bf">:</span>
            <span style="color:#e5c07b">print</span><span style="color:#abb2bf">(</span><span style="color:#63c381">&#34;error:登录出错&#34;</span><span style="color:#abb2bf">)</span>
</code></pre></td></tr></table>
</div>
</div><p>接下来进行一次查询操作 <img src="https://cloud.css0209.cn/2018/08/QQ20180812-183454.png" alt="">
可以看到这个东西<br>
<code>https://220.167.53.63:95/(xg1yk155oifue555urpnb0ng)/xscjcx.aspx?xh=\[学号\]&amp;xm=\[URL化的姓名\]&amp;gnmkdm=N121605</code><br>
这个地址是声明我们从哪里来的，我们可以由拼接生成</p>
<div class="highlight"><div style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"> <span style="color:#8a93a5;font-style:italic"># 获取URL化后的姓名</span>
            <span style="color:#aa89ea">name</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">self</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">login</span><span style="color:#abb2bf">()</span><span style="color:#8a93a5;font-style:italic">#这里是刚刚获取的URL话的名字</span>
            <span style="color:#aa89ea">grade_url</span> <span style="color:#54b1c7">=</span> <span style="color:#63c381">&#34;</span><span style="color:#98c379">{}</span><span style="color:#63c381">(</span><span style="color:#98c379">{}</span><span style="color:#63c381">)/xscjcx.aspx?xh=</span><span style="color:#98c379">{}</span><span style="color:#63c381">&amp;xm=</span><span style="color:#98c379">{}</span><span style="color:#63c381">&amp;gnmkdm=N121605&#34;</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">format</span><span style="color:#abb2bf">(</span><span style="color:#aa89ea">self</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">url</span><span style="color:#abb2bf">,</span> <span style="color:#aa89ea">self</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">token</span><span style="color:#abb2bf">,</span> <span style="color:#aa89ea">self</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">user</span><span style="color:#abb2bf">,</span> <span style="color:#aa89ea">name</span><span style="color:#abb2bf">)</span>  <span style="color:#8a93a5;font-style:italic"># 生成URL </span>

<span style="color:#aa89ea">我们要把这个写入headers</span>，<span style="color:#aa89ea">这里要注意的是这个headers里Referer是一定要有的</span>

    <span style="color:#aa89ea">header</span> <span style="color:#54b1c7">=</span> <span style="color:#abb2bf">{</span>
                    <span style="color:#63c381">&#34;Referer&#34;</span><span style="color:#abb2bf">:</span> <span style="color:#aa89ea">grade_url</span><span style="color:#abb2bf">,</span>  <span style="color:#8a93a5;font-style:italic"># Referer必须有</span>
                    <span style="color:#63c381">&#34;User-Agent&#34;</span><span style="color:#abb2bf">:</span> <span style="color:#63c381">&#34;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.110 Safari/537.36&#34;</span>
                <span style="color:#abb2bf">}</span>  <span style="color:#8a93a5;font-style:italic"># 生成header </span>
</code></pre></td></tr></table>
</div>
</div><p>再来看下我们提交的东西   <img src="https://cloud.css0209.cn/2018/08/QQ20180812-183734.png" alt="">
这一看，妈哟！这么长的什么东西！？ 不要慌，回到之前页面看看 从表单那可以看到这么些东西<br>
<img src="https://cloud.css0209.cn/2018/08/QQ20180812-204015.png" alt="">   可以发现这些值就是我们需要的，那么爬取下来即可</p>
<div class="highlight"><div style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">    <span style="color:#aa89ea">r</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">requests</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">get</span><span style="color:#abb2bf">(</span><span style="color:#aa89ea">grade_url</span><span style="color:#abb2bf">,</span> <span style="color:#aa89ea">headers</span><span style="color:#54b1c7">=</span><span style="color:#aa89ea">header</span><span style="color:#abb2bf">)</span>
                <span style="color:#aa89ea">r</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">encoding</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">r</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">apparent_encoding</span>
                <span style="color:#63c381">&#34;&#34;&#34;
</span><span style="color:#63c381">                r = requests.get(&#34;</span><span style="color:#98c379">{}</span><span style="color:#63c381">/</span><span style="color:#98c379">{}</span><span style="color:#63c381">/xscjcx.aspx?</span><span style="color:#98c379">{}</span><span style="color:#63c381">&#34;.format(self.url, self.token, urllib.parse.urlencode({
</span><span style="color:#63c381">                    &#39;xh&#39;: self.user,
</span><span style="color:#63c381">                    &#39;xm&#39;: info[2],
</span><span style="color:#63c381">                    &#39;gnmkdm&#39;: &#39;N121603&#39;
</span><span style="color:#63c381">                })))
</span><span style="color:#63c381">                &#34;&#34;&#34;</span>
                <span style="color:#aa89ea">soup</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">BeautifulSoup</span><span style="color:#abb2bf">(</span><span style="color:#aa89ea">r</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">text</span><span style="color:#abb2bf">,</span> <span style="color:#98c379">&#39;lxml&#39;</span><span style="color:#abb2bf">)</span>
                <span style="color:#8a93a5;font-style:italic"># 获取表单信息</span>
                <span style="color:#aa89ea">__EVENTTARGET</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">soup</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">select_one</span><span style="color:#abb2bf">(</span><span style="color:#98c379">&#39;input[name=&#34;__EVENTTARGET&#34;]&#39;</span><span style="color:#abb2bf">)</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">get</span><span style="color:#abb2bf">(</span><span style="color:#63c381">&#34;value&#34;</span><span style="color:#abb2bf">)</span>
                <span style="color:#aa89ea">__EVENTARGUMENT</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">soup</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">select_one</span><span style="color:#abb2bf">(</span><span style="color:#98c379">&#39;input[name=&#34;__EVENTARGUMENT&#34;]&#39;</span><span style="color:#abb2bf">)</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">get</span><span style="color:#abb2bf">(</span><span style="color:#63c381">&#34;value&#34;</span><span style="color:#abb2bf">)</span>
                <span style="color:#aa89ea">new__VIEWSTATE</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">soup</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">select_one</span><span style="color:#abb2bf">(</span><span style="color:#98c379">&#39;input[name=&#34;__VIEWSTATE&#34;]&#39;</span><span style="color:#abb2bf">)</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">get</span><span style="color:#abb2bf">(</span><span style="color:#63c381">&#34;value&#34;</span><span style="color:#abb2bf">)</span> 
</code></pre></td></tr></table>
</div>
</div><table>
<thead>
<tr>
<th>值</th>
<th>对应的value</th>
</tr>
</thead>
<tbody>
<tr>
<td>那么还有4个值</td>
<td>ddlXN</td>
</tr>
<tr>
<td>表单中的学年</td>
<td>ddlXQ</td>
</tr>
<tr>
<td>表单中的学期</td>
<td>ddl_kcxz</td>
</tr>
<tr>
<td>表单中的课程性质</td>
<td>btn_xq</td>
</tr>
<tr>
<td>点击的哪个按钮，这里我默认用学期成绩按钮</td>
<td></td>
</tr>
</tbody>
</table>
<p>这里的<code>ddlXN</code>和<code>ddlXQ</code>我们让用户来输入 <code>ddl_kcxz</code>设为空和<code>btn_xq</code>为URL化的“学期成绩” 把表单信息存入data</p>
<div class="highlight"><div style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"> <span style="color:#aa89ea">grade_data</span> <span style="color:#54b1c7">=</span> <span style="color:#abb2bf">{</span>
                <span style="color:#63c381">&#34;__EVENTTARGET&#34;</span><span style="color:#abb2bf">:</span> <span style="color:#aa89ea">__EVENTTARGET</span><span style="color:#abb2bf">,</span>
                <span style="color:#63c381">&#34;__EVENTARGUMENT&#34;</span><span style="color:#abb2bf">:</span> <span style="color:#aa89ea">__EVENTARGUMENT</span><span style="color:#abb2bf">,</span>
                <span style="color:#63c381">&#34;__VIEWSTATE&#34;</span><span style="color:#abb2bf">:</span> <span style="color:#aa89ea">new__VIEWSTATE</span><span style="color:#abb2bf">,</span>
                <span style="color:#63c381">&#34;ddlXN&#34;</span><span style="color:#abb2bf">:</span> <span style="color:#e5c07b">input</span><span style="color:#abb2bf">(</span><span style="color:#63c381">&#34;请输入学年(如：2017-2018):&#34;</span><span style="color:#abb2bf">),</span>
                <span style="color:#63c381">&#34;ddlXQ&#34;</span><span style="color:#abb2bf">:</span> <span style="color:#e5c07b">input</span><span style="color:#abb2bf">(</span><span style="color:#63c381">&#34;请输入学期(如：1):&#34;</span><span style="color:#abb2bf">),</span>
                <span style="color:#63c381">&#34;ddl_kcxz&#34;</span><span style="color:#abb2bf">:</span> <span style="color:#63c381">&#34;&#34;</span><span style="color:#abb2bf">,</span>
                <span style="color:#63c381">&#34;btn_xq&#34;</span><span style="color:#abb2bf">:</span> <span style="color:#aa89ea">urllib</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">parse</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">quote</span><span style="color:#abb2bf">(</span><span style="color:#63c381">&#34;学期成绩&#34;</span><span style="color:#abb2bf">)</span>
            <span style="color:#abb2bf">}</span> 
</code></pre></td></tr></table>
</div>
</div><p>有了信息后我们进行访问，会获得一些信息,然后我们将这些信息提取出来,然后写入HTML文档里</p>
<div class="highlight"><div style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">30
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">            <span style="color:#aa89ea">grade_html</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">session</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">post</span><span style="color:#abb2bf">(</span><span style="color:#aa89ea">grade_url</span><span style="color:#abb2bf">,</span> <span style="color:#aa89ea">headers</span><span style="color:#54b1c7">=</span><span style="color:#aa89ea">header</span><span style="color:#abb2bf">,</span> <span style="color:#aa89ea">data</span><span style="color:#54b1c7">=</span><span style="color:#aa89ea">grade_data</span><span style="color:#abb2bf">)</span>
            <span style="color:#aa89ea">soup_grade</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">BeautifulSoup</span><span style="color:#abb2bf">(</span><span style="color:#aa89ea">grade_html</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">text</span><span style="color:#abb2bf">,</span> <span style="color:#98c379">&#39;lxml&#39;</span><span style="color:#abb2bf">)</span>
            <span style="color:#aa89ea">title</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">soup_grade</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">select</span><span style="color:#abb2bf">(</span><span style="color:#98c379">&#39;font[size=&#34;4&#34;]&#39;</span><span style="color:#abb2bf">)[</span><span style="color:#d19a66">0</span><span style="color:#abb2bf">]</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">text</span>  <span style="color:#8a93a5;font-style:italic"># 标题</span>
            <span style="color:#aa89ea">xh</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">soup_grade</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">select_one</span><span style="color:#abb2bf">(</span><span style="color:#98c379">&#39;span#lbl_xh&#39;</span><span style="color:#abb2bf">)</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">text</span>  <span style="color:#8a93a5;font-style:italic"># 学号</span>
            <span style="color:#aa89ea">xm</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">soup_grade</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">select_one</span><span style="color:#abb2bf">(</span><span style="color:#98c379">&#39;span#lbl_xm&#39;</span><span style="color:#abb2bf">)</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">text</span>  <span style="color:#8a93a5;font-style:italic"># 姓名</span>
            <span style="color:#aa89ea">xy</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">soup_grade</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">select_one</span><span style="color:#abb2bf">(</span><span style="color:#98c379">&#39;span#lbl_xy&#39;</span><span style="color:#abb2bf">)</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">text</span>  <span style="color:#8a93a5;font-style:italic"># 学院</span>
            <span style="color:#aa89ea">zy</span> <span style="color:#54b1c7">=</span> <span style="color:#98c379">&#39;专业：</span><span style="color:#98c379">{}</span><span style="color:#98c379">&#39;</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">format</span><span style="color:#abb2bf">(</span><span style="color:#aa89ea">soup_grade</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">select_one</span><span style="color:#abb2bf">(</span><span style="color:#98c379">&#39;span#lbl_zymc&#39;</span><span style="color:#abb2bf">)</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">text</span><span style="color:#abb2bf">)</span>  <span style="color:#8a93a5;font-style:italic"># 专业</span>
            <span style="color:#aa89ea">xzb</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">soup_grade</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">select_one</span><span style="color:#abb2bf">(</span><span style="color:#98c379">&#39;span#lbl_xzb&#39;</span><span style="color:#abb2bf">)</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">text</span>  <span style="color:#8a93a5;font-style:italic"># 行政班</span>
            <span style="color:#aa89ea">table</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">soup_grade</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">select_one</span><span style="color:#abb2bf">(</span><span style="color:#98c379">&#39;table#Datagrid1&#39;</span><span style="color:#abb2bf">)</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">prettify</span><span style="color:#abb2bf">()</span>  <span style="color:#8a93a5;font-style:italic"># 成绩表</span>
            <span style="color:#aa89ea">grade_table</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">re</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">sub</span><span style="color:#abb2bf">(</span><span style="color:#98c379">&#39;&#34;datelist&#34;&#39;</span><span style="color:#abb2bf">,</span> <span style="color:#98c379">&#39;&#34;mdui-table&#34;&#39;</span><span style="color:#abb2bf">,</span> <span style="color:#aa89ea">table</span><span style="color:#abb2bf">)</span>
            <span style="color:#aa89ea">grade</span> <span style="color:#54b1c7">=</span> <span style="color:#aa89ea">title</span> <span style="color:#54b1c7">+</span> <span style="color:#63c381">&#34;&lt;br/&gt;&#34;</span> <span style="color:#54b1c7">+</span> <span style="color:#aa89ea">xh</span> <span style="color:#54b1c7">+</span> <span style="color:#63c381">&#34;&lt;br/&gt;&#34;</span> <span style="color:#54b1c7">+</span> <span style="color:#aa89ea">xm</span> <span style="color:#54b1c7">+</span> <span style="color:#63c381">&#34;&lt;br/&gt;&#34;</span> <span style="color:#54b1c7">+</span> <span style="color:#aa89ea">xy</span> <span style="color:#54b1c7">+</span> <span style="color:#63c381">&#34;&lt;br/&gt;&#34;</span> <span style="color:#54b1c7">+</span> <span style="color:#aa89ea">zy</span> <span style="color:#54b1c7">+</span> <span style="color:#63c381">&#34;&lt;br/&gt;&#34;</span> <span style="color:#54b1c7">+</span> <span style="color:#aa89ea">xzb</span> <span style="color:#54b1c7">+</span> <span style="color:#63c381">&#34;&lt;br/&gt;&#34;</span> <span style="color:#54b1c7">+</span> <span style="color:#aa89ea">grade_table</span>
            <span style="color:#aa89ea">html</span> <span style="color:#54b1c7">=</span> <span style="color:#98c379">&#39;&#39;&#39;&lt;!doctype html&gt;
</span><span style="color:#98c379">    &lt;html lang=&#34;zh-cn&#34;&gt;
</span><span style="color:#98c379">    &lt;head&gt;
</span><span style="color:#98c379">        &lt;meta charset=&#34;UTF-8&#34;&gt;
</span><span style="color:#98c379">        &lt;meta name=&#34;viewport&#34;
</span><span style="color:#98c379">              content=&#34;width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0&#34;&gt;
</span><span style="color:#98c379">        &lt;meta http-equiv=&#34;X-UA-Compatible&#34; content=&#34;ie=edge&#34;&gt;
</span><span style="color:#98c379">        &lt;title&gt;</span><span style="color:#98c379">{}</span><span style="color:#98c379">同学的成绩单&lt;/title&gt;
</span><span style="color:#98c379">        &lt;link rel=&#34;stylesheet&#34; href=&#34;http://cdnjs.loli.net/ajax/libs/mdui/0.4.1/css/mdui.min.css&#34;&gt;
</span><span style="color:#98c379">    &lt;/head&gt;
</span><span style="color:#98c379">    &lt;body&gt;
</span><span style="color:#98c379">            &#39;&#39;&#39;</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">format</span><span style="color:#abb2bf">(</span><span style="color:#aa89ea">urllib</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">parse</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">unquote</span><span style="color:#abb2bf">(</span><span style="color:#aa89ea">name</span><span style="color:#abb2bf">))</span>
            <span style="color:#8a93a5;font-style:italic"># 将内容写入html文件</span>
            <span style="color:#76a9f9">with</span> <span style="color:#e5c07b">open</span><span style="color:#abb2bf">(</span><span style="color:#98c379">&#39;./index.html&#39;</span><span style="color:#abb2bf">,</span> <span style="color:#98c379">&#39;a+&#39;</span><span style="color:#abb2bf">)</span> <span style="color:#76a9f9">as</span> <span style="color:#aa89ea">f</span><span style="color:#abb2bf">:</span>
                <span style="color:#aa89ea">f</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">truncate</span><span style="color:#abb2bf">(</span><span style="color:#d19a66">0</span><span style="color:#abb2bf">)</span>
                <span style="color:#aa89ea">f</span><span style="color:#54b1c7">.</span><span style="color:#aa89ea">write</span><span style="color:#abb2bf">(</span><span style="color:#aa89ea">html</span> <span style="color:#54b1c7">+</span> <span style="color:#aa89ea">grade</span><span style="color:#abb2bf">)</span>
            <span style="color:#e5c07b">print</span><span style="color:#abb2bf">(</span><span style="color:#63c381">&#34;it&#39;s done!&#34;</span><span style="color:#abb2bf">)</span>
        <span style="color:#76a9f9">except</span><span style="color:#abb2bf">:</span>
            <span style="color:#e5c07b">print</span><span style="color:#abb2bf">(</span><span style="color:#63c381">&#34;error:获取成绩单出错&#34;</span><span style="color:#abb2bf">)</span>
</code></pre></td></tr></table>
</div>
</div><p>完整代码：  <a href="httpw://github.com/idoctype/zhengfang">GitHub</a>
接下来，我想把这个用Django写成web端，但是验证码哪里给卡着了</p>

      <div class="postFooter">
        
        
        <small class="tags">
          <i class="fa fa-tag" aria-hidden="true"></i>Python
        </small>
        
        
      </div>
      <div>
        <ul class="post-copyright">
          <li class="post-copyright-link"><strong>本文链接：</strong> <a href="/103.html" title="Python3 正方爬虫 "
              class="line">Python3 正方爬虫</a></li>
          <li class="post-copyright-license"><strong>版权声明：</strong> 本<span xmlns:dct="http://purl.org/dc/terms/"
              href="http://purl.org/dc/dcmitype/Text" rel="dct:type">作品</span>由<span
              xmlns:cc="http://creativecommons.org/ns#" property="cc:attributionName">Yazzyk</span>采用<a
              rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/deed.zh">知识共享署名-非商业性使用 4.0
              国际许可协议</a>进行许可。<br />基于<a xmlns:dct="http://purl.org/dc/terms/" href="https://css0209.cn"
              rel="dct:source">Yazzyk&#39;s Blog</a>上的作品创作。转载请注明出处！</li>
        </ul>
      </div>
      
      
    </div>
  </div>
  <footer>
  <div class="leftBox">
    <span>Theme Designed by <a href="https://shroot.dev" target="_blank">Yazzyk</a></span><br />
    <span>Proudly published with <a href="https://gohugo.io" target="_blank">Hugo</a></span>
  </div>
  <div class="rightBox">
    <span>Copyright © 2020-2022.12 <a href="https://shroot.dev">Yazzyk</a> All Rights Reserved</span><br />
    
    
  </div>
</footer>
</body>

<script src="https://shroot.dev/js/list.js"></script>
<script src="https://shroot.dev/js/post.js"></script>